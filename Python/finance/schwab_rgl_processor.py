import pandas as pd\nfrom pathlib import Path\nimport sys\nimport re\n\ndef process_rgl(new_summary: str, new_details: str, tracker_path: str = &#x27;memory/schwab-rgl-tracker.md&#x27;, master_dir: str = &#x27;Data/Private/finance/schwab-brokerage/realized-gain-loss&#x27;):\n    master_summary = Path(master_dir) / &#x27;master_rgl_summary.csv&#x27;\n    master_details = Path(master_dir) / &#x27;master_rgl_details.csv&#x27;\n\n    # Load new CSVs (Schwab format: skip rows if header mess)\n    df_sum = pd.read_csv(new_summary, skiprows=1)  # Adjust if needed\n    df_det = pd.read_csv(new_details, skiprows=1)\n\n    # Dedup keys\n    key_det = [&#x27;Symbol&#x27;, &#x27;Closed Date&#x27;, &#x27;Quantity&#x27;, &#x27;Proceeds Per Share&#x27;]\n    key_sum = [&#x27;Symbol&#x27;, &#x27;Closed Date&#x27;]\n\n    # Append/dedup details\n    if master_details.exists():\n        master_det = pd.read_csv(master_details)\n        df_det = pd.concat([master_det, df_det]).drop_duplicates(subset=key_det).sort_values(&#x27;Closed Date&#x27;)\n    df_det.to_csv(master_details, index=False)\n\n    # Append/dedup summary\n    if master_summary.exists():\n        master_sum = pd.read_csv(master_summary)\n        df_sum = pd.concat([master_sum, df_sum]).drop_duplicates(subset=key_sum).sort_values(&#x27;Closed Date&#x27;)\n    df_sum.to_csv(master_summary, index=False)\n\n    # Update tracker\n    last_date = pd.to_datetime(df_det[&#x27;Closed Date&#x27;].max()).strftime(&#x27;%Y-%m-%d&#x27;)\n    with open(tracker_path, &#x27;r&#x27;) as f:\n        content = f.read()\n    content = re.sub(r&#x27;last_end_date: .*&#x27;, f&#x27;last_end_date: {last_date}&#x27;, content)\n    with open(tracker_path, &#x27;w&#x27;) as f:\n        f.write(content)\n\n    print(f&quot;âœ… Masters updated to {last_date}. Rows: sum={len(df_sum)}, det={len(df_det)}&quot;)\n\nif __name__ == &#x27;__main__&#x27;:\n    if len(sys.argv) &lt; 3:\n        print(&quot;Usage: python schwab_rgl_processor.py &lt;summary.csv&gt; &lt;details.csv&gt;&quot;)\n    else:\n        process_rgl(sys.argv[1], sys.argv[2])\n